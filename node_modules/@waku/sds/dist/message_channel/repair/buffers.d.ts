import type { HistoryEntry, MessageId } from "../message.js";
/**
 * Entry in the outgoing repair buffer with request timing
 */
interface OutgoingBufferEntry {
    entry: HistoryEntry;
    tReq: number;
    requested: boolean;
}
/**
 * Entry in the incoming repair buffer with response timing
 */
interface IncomingBufferEntry {
    entry: HistoryEntry;
    tResp: number;
}
/**
 * Buffer for outgoing repair requests (messages we need)
 * Maintains a sorted array by T_req for efficient retrieval of eligible entries
 */
export declare class OutgoingRepairBuffer {
    private items;
    private readonly maxSize;
    constructor(maxSize?: number);
    /**
     * Add a missing message to the outgoing repair request buffer
     * If message already exists, it is not updated (keeps original T_req)
     * @returns true if the entry was added, false if it already existed
     */
    add(entry: HistoryEntry, tReq: number): boolean;
    /**
     * Remove a message from the buffer (e.g., when received)
     */
    remove(messageId: MessageId): void;
    /**
     * Get eligible repair requests (where T_req <= currentTime)
     * Returns up to maxRequests entries from the front of the sorted array
     * Marks returned entries as requested but keeps them in buffer until received
     */
    getEligible(currentTime?: number, maxRequests?: number): HistoryEntry[];
    /**
     * Check if a message is in the buffer
     */
    has(messageId: MessageId): boolean;
    /**
     * Get the current buffer size
     */
    get size(): number;
    /**
     * Clear all entries
     */
    clear(): void;
    /**
     * Get all entries (for testing/debugging)
     */
    getAll(): HistoryEntry[];
    /**
     * Get items array directly (for testing)
     */
    getItems(): OutgoingBufferEntry[];
}
/**
 * Buffer for incoming repair requests (repairs we need to send)
 * Maintains a sorted array by T_resp for efficient retrieval of ready entries
 */
export declare class IncomingRepairBuffer {
    private items;
    private readonly maxSize;
    constructor(maxSize?: number);
    /**
     * Add a repair request that we can fulfill
     * If message already exists, it is ignored (not updated)
     * @returns true if the entry was added, false if it already existed
     */
    add(entry: HistoryEntry, tResp: number): boolean;
    /**
     * Remove a message from the buffer
     */
    remove(messageId: MessageId): void;
    /**
     * Get repairs ready to be sent (where T_resp <= currentTime)
     * Removes and returns ready entries
     */
    getReady(currentTime: number): HistoryEntry[];
    /**
     * Check if a message is in the buffer
     */
    has(messageId: MessageId): boolean;
    /**
     * Get the current buffer size
     */
    get size(): number;
    /**
     * Clear all entries
     */
    clear(): void;
    /**
     * Get all entries (for testing/debugging)
     */
    getAll(): HistoryEntry[];
    /**
     * Get items array directly (for testing)
     */
    getItems(): IncomingBufferEntry[];
}
export {};
